<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="com.face.mybatis.myLectureMapper">
 
<select id="countMyLecture" resultType="int">
	select count (*) from myLecture where id=#{id}
</select> 

<select id="selectMyLecture" parameterType="com.face.model.PagingVO" resultType="com.face.model.MyLectureVO">
    
    select max(rn) rn, max(mylectureno) mylectureno, max(id) id, max(lectureno) lectureno, name, max(episode) episode, max(path) path 
    	from (select rownum rn, a.* 
    		from (select m.mylectureno, m.id, l.lectureno, l.name, l.episode, path
	            	from mylecture m, lecture l
	        		where m.lectureno = l.lectureno order by m.mylectureno desc) a
	         ) 
	    group by name
		having max(rn) between #{start} and #{end} 

</select>

<select id="countMySubLecture" resultType="int">
	select count (*) 
		from lecture 
		where name=(select name 
						from lecture 
						where lectureno = #{myLectureNo})
</select> 


<select id="selectMySubLecture" parameterType="map" resultType="com.face.model.MyLectureVO">
    
	select * 
		from (select rownum rn, a.* 
				from (select m.id, m.mylectureno, l.episode, l.name, l.path 
                		from lecture l, mylecture m 
                		where l.lectureno = m.lectureno 
                    		and l.name = (select name 
                    						from lecture 
                    						where lectureno = (select lectureno 
                    											from mylecture 
                    											where mylectureno=#{myLectureNo}))
						order by l.lectureno desc) a
        	 )
		where rn between #{vo.start} and #{vo.end} 

</select>

<select id="selectConcentration" resultType="com.face.model.ConcentrationVO">
    select time, score from concentration where myLectureNo=#{myLectureNo}
</select>

<select id="selectMySubLecture2" resultType="com.face.model.MyLectureVO">
	select m.id, m.mylectureno, l.episode, l.name, l.path  from lecture l, mylecture m 
		where l.lectureno = m.lectureno 
		and mylectureno = #{myLectureNo}
</select>
 </mapper>
